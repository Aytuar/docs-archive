<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2020"><meta name="DC.rights.owner" content="(C) Copyright 2020"><meta name="DC.type" content="concept"><meta name="description" content="You can optimize the Puppet Enterprise (PE) databases to improve performance."><meta name="prodname" content="pe"><meta name="version" content="2019.7"><meta name="DC.format" content="HTML5"><meta name="DC.identifier" content="pe_database_maintenance"><link rel="stylesheet" type="text/css" href="commonltr.css"><title>Database maintenance</title></head><body><main role="main"><article role="article" aria-labelledby="ariaid-title1"><article class="nested0" aria-labelledby="ariaid-title1" id="pe_database_maintenance">
      <h1 class="title topictitle1" id="ariaid-title1">Database maintenance </h1>
      
      <div class="body conbody"><p class="shortdesc">You can optimize the <span class="ph">Puppet Enterprise (PE)</span> databases to improve
            performance.</p></div>
<article class="topic concept nested1" aria-labelledby="ariaid-title2" id="databases_in_pe">
    <h2 class="title topictitle2" id="ariaid-title2">Databases in <span class="ph">Puppet Enterprise</span>
    </h2>
    
    <div class="body conbody"><p class="shortdesc">
        <span class="ph">PE</span> uses <span class="ph">PostgreSQL</span> as the
        backend for its databases. Use the native tools in <span class="ph">PostgreSQL</span>
        to perform database exports and imports.</p>
        <p class="p">The <span class="ph">PE</span>
            <span class="ph">PostgreSQL</span> database includes the following databases:</p>
        <table class="table"><caption></caption><colgroup><col><col></colgroup><thead class="thead">
                    <tr class="row">
                        <th class="entry" id="databases_in_pe__entry__1">Database </th>
                        <th class="entry" id="databases_in_pe__entry__2">Description</th>
                    </tr>
                </thead><tbody class="tbody">
                    <tr class="row">
                        <td class="entry" headers="databases_in_pe__entry__1">pe-activity </td>
                        <td class="entry" headers="databases_in_pe__entry__2">Activity data from the
                            Classifier, including user, nodes, and time of activity.</td>
                    </tr>
                    <tr class="row">
                        <td class="entry" headers="databases_in_pe__entry__1">pe-classifier </td>
                        <td class="entry" headers="databases_in_pe__entry__2">Classification data, all node
                            group information.</td>
                    </tr>
                    <tr class="row">
                        <td class="entry" headers="databases_in_pe__entry__1">pe-puppetdb </td>
                        <td class="entry" headers="databases_in_pe__entry__2">
                            <span class="ph">PuppetDB</span> data, including exported
                            resources, catalogs, facts, and reports.</td>
                    </tr>
                    <tr class="row">
                        <td class="entry" headers="databases_in_pe__entry__1">pe-rbac </td>
                        <td class="entry" headers="databases_in_pe__entry__2">Role-based access control data,
                            including users, permissions, and AD/LDAP info.</td>
                    </tr>
                    <tr class="row">
                        <td class="entry" headers="databases_in_pe__entry__1">pe-orchestrator </td>
                        <td class="entry" headers="databases_in_pe__entry__2">Orchestrator data, including
                            user, node, and result details about job runs.</td>
                    </tr>
                </tbody></table>
    </div>
</article><article class="topic task nested1" aria-labelledby="ariaid-title3" id="optimize_a_database">
    <h2 class="title topictitle2" id="ariaid-title3">Optimize a database</h2>
    
    
    <div class="body taskbody"><p class="shortdesc">If your databases are slow, begin taking up too much disk
        space, or need general performance enhancements, use the <span class="ph">PostgreSQL</span>
        <code class="ph codeph">vacuum</code> command to optimize any of the <span class="ph">PE</span> databases.</p>
        <section><div class="li step p">
                <span class="ph cmd">To optimize a database, run: <code class="ph codeph">su - pe-postgres -s /bin/bash -c
                        "/opt/puppetlabs/server/bin/vacuumdb -z --verbose
                        &lt;DATABASE_NAME&gt;"</code>
                </span>
            </div></section>
    </div>
<nav role="navigation" class="related-links"><div class="linklist relinfo"><strong>Related information</strong><br><ul class="linklist"><li class="linklist"><a class="link" href="pe_database_maintenance.html#generate_a_list_of_database_names" title="Use these instructions to list all database names.">List all database names</a></li></ul></div></nav></article><article class="topic task nested1" aria-labelledby="ariaid-title4" id="generate_a_list_of_database_names">
    <h2 class="title topictitle2" id="ariaid-title4">List all database names</h2>
    
    

    <div class="body taskbody"><p class="shortdesc">Use these instructions to list all database
        names.</p>
        <section class="section context">
            <p class="p">To generate a list of database names:</p>
        </section>
        <section><ol class="ol steps"><li class="li step stepexpand">
                <span class="ph cmd">Assume the <code class="ph codeph">pe-postgres</code> user:</span>
                <div class="itemgroup info">
                    <pre class="pre codeblock"><code>sudo su - pe-postgres -s /bin/bash</code></pre>
                </div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Open the PostgreSQL command-line:</span>
                <div class="itemgroup info">
                    <pre class="pre codeblock"><code>/opt/puppetlabs/server/bin/psql</code></pre>
                </div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">List the databases:</span>
                <div class="itemgroup info">
                    <pre class="pre codeblock"><code>\l</code></pre>
                </div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Exit the PostgreSQL command line:</span>
                <div class="itemgroup info">
                    <pre class="pre codeblock"><code>\q</code></pre>
                </div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Log out of the <code class="ph codeph">pe-postgres</code> user:</span>
                <div class="itemgroup info">
                    <pre class="pre codeblock"><code>logout</code></pre>
                </div>
            </li></ol></section>
    </div>
</article></article></article></main></body></html>