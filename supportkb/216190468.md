# Avoid thundering herd in Puppet Enterprise 2015.3 and 2015.2: splay 
<p>Learn more about how <code>splay</code> works so that you can spread out agent catalog requests to the master and avoid a thundering herd condition.</p>
<p>For more information on how to spread out agent catalog requests, read the following:</p>
<ul>
<li><a href="https://support.puppet.com/hc/en-us/articles/229123007">Stop a thundering herd: Redistribute agent node check-ins with MCollective</a></li>
</ul>
<h3 id="version-and-installation-information">Version and installation information</h3>
<p><strong>PE version:</strong> 2015.3, 2015.2<br><strong>OS: </strong>Any *nix</p>
<h3 id="solution">Solution</h3>
<p>After you’ve added hundreds of nodes to your deployment you may notice that your agents are running slow or timing out. By default, when the agent service is started in PE and every 30 minutes after that, all of your agents might check in to retrieve a catalog at the same time. This could cause a thundering herd of processes, degrading CPU and memory performance. By adding a pseudorandom delay (sleep) before an agent checks in, <code>splay</code> can help address thundering herd problems .</p>
<h4 id="splay"><code>splay</code></h4>
<p>When <a href="https://github.com/puppetlabs/docs-archive/blob/main/puppet/4.2/configuration.md#splay"><code>splay</code></a> is enabled, the agent’s next check-in will occur after a pseudorandom delay. Following that, each check-in will happen every <a href="https://github.com/puppetlabs/docs-archive/blob/main/puppet/4.2/configuration.md#runinterval"><code>runinterval</code></a>, which is by default 30 minutes. When the <code>puppet</code> service is restarted on the agent, the first check-in will be after the same pseudorandom delay. Following that, the agent will check in every <code>runinterval</code>. Each agent node with <code>splay</code> enabled will have a different pseudorandom sleep time, thus spreading out the check-ins.</p>
<p>To enable <code>splay</code>, add <code>splay=true</code> to the agent section of your agent nodes’ <code>puppet.conf</code> file (default location <code>/etc/puppetlabs/puppet/puppet.conf</code> for *nix and <code>C:\ProgramData\PuppetLabs\puppet\etc for Windows</code>).</p>
<p>For example, without <code>splay</code> enabled, your agent checks in every 30 minutes at :01 and :31 past the hour. After enabling <code>splay</code>, the agent will wait the pseudorandom sleep time, say eight minutes, and then check in every 30 minutes, at :09 and :39 after the hour. If you restart the same agent at 12:45 PM, it will wait its eight minutes, and check in at 12:52 PM, and every 30 minutes after that, at 1:22 PM, 1:52 PM, and so on. Other agents will have different sleep times, and so will check in at different times even if they are all restarted at the same time.</p>
